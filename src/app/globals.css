@import url("https://fonts.googleapis.com/css2?family=VT323&display=swap");

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --bg: black;
  --text: #39ff14;
  font-family: "VT323", Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;

  /* --- CRT vars --- */
  --crt-scanline-opacity: 0.14; /* 0.10–0.20 doux */
  --crt-scanline-thick: 3px; /* période totale */
  --crt-scanline-dark: 1px; /* épaisseur ligne sombre */
  --crt-vignette: 0.2; /* 0–1 */
  --crt-flicker: 0.02; /* 0–0.05 recommandé */
}

body {
  background-color: var(--bg);
  color: var(--text);
}

/* ============================= */
/* ========== CRT FX =========== */
/* ============================= */

/* Overlay plein écran: scanlines + vignette */
.crt-overlay {
  pointer-events: none;
  position: fixed;
  inset: 0;
  z-index: 60;

  background-image:
    /* scanlines horizontales */ repeating-linear-gradient(
      to bottom,
      rgba(0, 0, 0, var(--crt-scanline-opacity)) 0,
      rgba(0, 0, 0, var(--crt-scanline-opacity)) var(--crt-scanline-dark),
      transparent var(--crt-scanline-dark),
      transparent var(--crt-scanline-thick)
    ),
    /* vignette douce */
      radial-gradient(
        ellipse at center,
        rgba(0, 0, 0, 0) 0%,
        rgba(0, 0, 0, 0) 60%,
        rgba(0, 0, 0, var(--crt-vignette)) 100%
      );
  background-blend-mode: multiply;
}

/* Bruit statique léger (pseudo grain) */
.crt-overlay::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;

  background-image: radial-gradient(
      rgba(255, 255, 255, 0.04) 0.6px,
      transparent 0.7px
    ),
    radial-gradient(rgba(0, 0, 0, 0.04) 0.6px, transparent 0.7px);
  background-size: 3px 3px, 3px 3px;
  background-position: 0 0, 1.5px 1.5px;

  animation: crt-noise 8s steps(60) infinite;
  mix-blend-mode: overlay;
}

/* Shadow mask RVB quasi imperceptible */
.crt-overlay::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;

  background-image: repeating-linear-gradient(
    to right,
    rgba(255, 0, 0, 0.06) 0,
    rgba(255, 0, 0, 0.06) 1px,
    rgba(0, 255, 0, 0.06) 1px,
    rgba(0, 255, 0, 0.06) 2px,
    rgba(0, 0, 255, 0.06) 2px,
    rgba(0, 0, 255, 0.06) 3px,
    transparent 3px,
    transparent 4px
  );
  opacity: 0.08;
  mix-blend-mode: soft-light;
}

/* Contenu: halo + frange RVB douce */
.crt-content {
  filter: contrast(1.03) saturate(1.05) blur(0.1px);
  text-shadow: -0.3px 0 rgba(255, 0, 0, 0.1), 0.3px 0 rgba(0, 255, 255, 0.1),
    0 0 0.4px rgba(255, 255, 255, 0.3), 0 0 1px rgba(255, 255, 255, 0.12);
}

/* Utilitaire si tu veux cibler: class="crt-fringe" */
.crt-fringe {
  text-shadow: -0.3px 0 rgba(255, 0, 0, 0.12), 0.3px 0 rgba(0, 255, 255, 0.12),
    0 0 0.4px rgba(255, 255, 255, 0.3);
}

/* Flicker très léger */
@keyframes crt-flicker {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: calc(1 - var(--crt-flicker));
  }
}
.crt-overlay {
  animation: crt-flicker 6s ease-in-out infinite;
}

/* Micro-mouvement du bruit */
@keyframes crt-noise {
  0% {
    transform: translate(0, 0);
  }
  50% {
    transform: translate(0.5px, -0.5px);
  }
  100% {
    transform: translate(0, 0);
  }
}

/* Respecte prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
  .crt-overlay {
    animation: none;
  }
  .crt-overlay::before {
    animation: none;
  }
}

/* Toggle rapide: ajouter 'no-crt' sur <html> */
html.no-crt .crt-overlay,
html.no-crt .crt-content {
  animation: none !important;
  background: none !important;
  filter: none !important;
  text-shadow: none !important;
}
